# 跨域问题修复记录

## 问题描述

前端执行`buyGoods.js`时出现跨域问题：

```
Access to XMLHttpRequest at 'http://127.0.0.1:9222/json/version' from origin 'http://localhost:5173' has been blocked by CORS policy: No 'Access-Control-Allow-Origin' header is present on the requested resource.
```

这是因为前端代码（运行在`http://localhost:5173`）尝试直接访问Chrome浏览器的调试接口（位于`http://127.0.0.1:9222/json/version`），但由于跨域限制，这个请求被阻止了。

## 解决方案

将自动下单功能从前端移到Electron的后端（主进程）执行，避免跨域问题：

1. 创建`electron/main/buyGoods.ts`文件，将前端的`executeBuyGoods`函数迁移到这里
2. 修改`electron/puppeteer/buyGoodsUseExcel.tsx`，使用新创建的后端函数
3. 修改前端组件`src/views/buyGoodsUseExcel.tsx`，通过IPC调用后端功能而不是直接调用前端函数
4. 增强主进程的IPC处理程序，添加日志传递功能，使日志能显示在前端界面

## 修改的文件

1. electron/main/buyGoods.ts (新建)
2. electron/puppeteer/buyGoodsUseExcel.tsx
3. electron/main/index.ts
4. src/views/buyGoodsUseExcel.tsx

## 技术要点

1. 通过Electron主进程访问本地资源，避免浏览器的同源策略限制
2. 使用IPC (Inter-Process Communication) 实现前后端通信
3. 使用事件机制（ipcRenderer.on/ipcMain.send）实现实时日志传递 